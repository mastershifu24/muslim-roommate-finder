{% extends "base.html" %}
{% load static %}

{% block title %}{{ room.title }} - Muslim Roommate Finder{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
    <a href="{% url 'home' %}" class="btn btn-outline-secondary">← Back to Home</a>
    
    <div class="d-flex gap-2">
        {% if user.is_authenticated and user.profile and user.profile != room.user %}
            <a href="{% url 'compose_message_to' room.user.id %}" class="btn btn-primary">
                <i class="fas fa-envelope me-1"></i>Message Owner
            </a>
            <a href="{% url 'contact_profile' room.user.id %}" class="btn btn-outline-success">
                <i class="fas fa-user me-1"></i>View Profile
            </a>
        {% endif %}
        
        {% if user.is_authenticated and room.user == user.profile %}
            <a href="{% url 'room_edit' room.pk %}" class="btn btn-warning">
                <i class="fas fa-edit me-1"></i>Edit Room
            </a>
            <a href="{% url 'room_delete' room.pk %}" class="btn btn-outline-danger"
               onclick="return confirm('Are you sure you want to delete this room?');">
                <i class="fas fa-trash me-1"></i>Delete Room
            </a>
        {% endif %}
        
        {% if not user.is_authenticated %}
            <a href="{% url 'login' %}" class="btn btn-primary">Login to Contact Owner</a>
        {% endif %}
    </div>
</div>

<div class="card mt-3">
  <div class="card-header bg-success text-white">
    <h2 class="mb-0">{{ room.title }}</h2>
  </div>
  <div class="card-body">
    {% if room.image %}
      <img src="{{ room.image.url }}" class="img-fluid mb-3 rounded" alt="Room image">
    {% else %}
      <img src="{% static 'images/no-image.jpg' %}" class="img-fluid mb-3 rounded" alt="No image available">
    {% endif %}

    <p class="text-muted mb-1"><strong>Location:</strong> {{ room.city }}{% if room.neighborhood %} • {{ room.neighborhood }}{% endif %}</p>
    {% if room.rent %}<p class="mb-1"><strong>Rent:</strong> ${{ room.rent }}</p>{% endif %}
    {% if room.available_from %}<p class="mb-3"><strong>Available from:</strong> {{ room.available_from }}</p>{% endif %}
    {% if room.description %}<p>{{ room.description }}</p>{% endif %}

    <div class="d-flex flex-wrap gap-2 mb-3">
      {% if room.only_eats_zabihah %}<span class="badge bg-success">Halal Kitchen</span>{% endif %}
      {% if room.prayer_friendly %}<span class="badge bg-info">Prayer Friendly</span>{% endif %}
      {% if room.guests_allowed %}<span class="badge bg-warning">Guests Allowed</span>{% endif %}
    </div>

    {% if room.contact_email %}<p><strong>Contact:</strong> {{ room.contact_email }}</p>{% endif %}
    {% if room.user %}<p class="text-muted">Posted by: {{ room.user.name }}</p>{% endif %}
  </div>
</div>
{% endblock %}
